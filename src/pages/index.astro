---

import { getRelativeLocaleUrl } from 'astro:i18n'
import { PostPreview } from 'astro-pure/components/pages'
import { getBlogCollectionByLocale, sortMDByDate } from 'astro-pure/server'
import { Button } from 'astro-pure/user'
import PageLayout from '@/layouts/BaseLayout.astro'
import Section from '@/components/home/Section.astro'
import maze from "@/assets/icons/ww-maze.svg?raw";

export { getLangStaticPaths as getStaticPaths } from 'astro-pure/server'

export const prerender = true

const MAX_POSTS = 10
const allPosts = await getBlogCollectionByLocale(Astro.currentLocale)
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)

const multiligualContent = {
  en: { 
    home: 'Home',
    title: 'Human Insight shaping purpose-driven digital systems.', 
    subtitle: 'The sophistication of computer systems is growing faster than our ability to absorb them, reshaping economic, political, and social power. My pursuit is about technology that strengthens human values instead of replacing them.',
    description: "I'm an Informatics Engineer driven by the transformative potential of knowledge to improve our lives and our world. Over the past decade, I've been contributing to the development of platforms—from helping shape ideas to measuring their impact—engaging with every phase of the software lifecycle. I have the conviction that we're on the greatest technological revolution, and it's more important than ever that we shape the future collectively.",
    about: 'About',
    posts: 'Posts',
    button_more_about: 'Know more',
    button_posts: 'All posts'
  },
  es: {
    home: 'Inicio',
    title: 'Comprensión humana para sistemas digitales con propósito.',
    subtitle: 'La sofisticación de los sistemas informáticos crece más rápido que nuestra capacidad para asimilarlos, reordenando el poder económico, político y social. Persigo tecnología que fortalece valores humanos, en lugar de sustituirlos.',
    description: 'Soy un Ingeniero Informático motivado por la capacidad transformadora del conocimiento para mejorar nuestras vidas y nuestro mundo. Durante la última década, he contribuido al desarrollo de plataformas, desde ayudar a dar forma a las ideas hasta medir su impacto, participando en todas las fases del ciclo de vida del software. Tengo la convicción de que estamos ante la más grande revolución tecnológica y que es más importante que nunca forjar el futuro colectivamente.',
    about: 'Sobre mí',
    posts: 'Publicaciones',
    button_more_about: 'Saber más',
    button_posts: 'Todas las publicaciones'
  }
};
const content = multiligualContent[Astro.currentLocale as keyof typeof multiligualContent];
---

<PageLayout meta={{ title: content.home }}}>
  <div class='labyrinth-bg' aria-hidden='true' slot='background'></div>
  <div class='flex w-full flex-col gap-y-10 md:w-4/5 lg:w-5/6 mx-auto'>
    <div>
      <Fragment style="margin: auto;" set:html={maze} />
    </div>
    <section class='animate flex flex-col items-center gap-y-7 mb-9'>

      <div class='flex flex-col items-center gap-y-4'>
        <!-- <h1 class='text-3xl font-bold text-center'>Andres Guillermo Soto-Rangel</h1> -->
        <h3 class='text-3xl font-bold text-center'>{content.title}</h3>
        <h3 class='text-xl text-center'>{content.subtitle}</h3>
        
      </div>
    </section>

    <Section title={content.about}>
      <p class='text-muted-foreground'>
        {content.description}
      </p>
      <Button title={content.button_more_about} class='w-fit self-end' href={`${getRelativeLocaleUrl(Astro.currentLocale as string, '/about')}`} style='ahead' />
    </Section>
    {
      allPostsByDate.length > 0 && (
        <Section title={content.posts}>
          <ul class='flex flex-col gap-y-1.5 sm:gap-y-2'>
            {allPostsByDate.map((p) => (
              <li class='flex flex-col gap-x-2 sm:flex-row'>
                {/* @ts-ignore */}
                <PostPreview post={p} />
              </li>
            ))}
          </ul>
          <Button title={content.button_posts} class='w-fit self-end' href={`${getRelativeLocaleUrl(Astro.currentLocale as string, '/blog')}`} style='ahead' />
        </Section>
      )
    }

  </div>
</PageLayout>
  <style is:global>
    .labyrinth-bg {
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      --s: 250px;
      --c1: hsl(var(--background));
      --c2: hsl(var(--muted));
      --ox: 0px;
      --oy: 0px;
      --_c: var(--c1) 25%, #0000 0;
      --_g1: conic-gradient(at 62.5% 12.5%, var(--_c));
      --_g2: conic-gradient(at 87.5% 62.5%, var(--_c));
      --_g3: conic-gradient(at 25% 12.5%, var(--_c));
      background:
        var(--_g1) calc(var(--s) / -8 + var(--ox)) calc(var(--s) / 2 + var(--oy)),
        var(--_g1) calc(-3 * var(--s) / 8 + var(--ox)) calc(var(--s) / 4 + var(--oy)),
        var(--_g2) calc(3 * var(--s) / 8 + var(--ox)) calc(var(--s) / 4 + var(--oy)),
        var(--_g2) calc(var(--s) / -8 + var(--ox)) calc(0px + var(--oy)),
        var(--_g3) calc(0px + var(--ox)) calc(var(--s) / -4 + var(--oy)),
        var(--_g3) calc(var(--s) / -4 + var(--ox)) calc(0px + var(--oy)),
        conic-gradient(at 87.5% 87.5%, var(--_c)) calc(var(--s) / 8 + var(--ox)) calc(0px + var(--oy)) var(--c2);
      background-size: var(--s) var(--s);
      opacity: .35;
      mix-blend-mode: multiply;
      will-change: background-position;
      
    }
    .dark .labyrinth-bg {
      --c1: hsl(var(--muted));
      --c2: hsl(var(--background));
      opacity: .15;
      mix-blend-mode: normal;
    }
  </style>
<script is:inline>
  const el = document.querySelector('.labyrinth-bg')
  const m = 12
  const onMove = (e) => {
    const x = (e.clientX / window.innerWidth - 0.5) * m
    const y = (e.clientY / window.innerHeight - 0.5) * m
    if (el) {
      el.style.setProperty('--ox', x + 'px')
      el.style.setProperty('--oy', y + 'px')
    }
  }
  window.addEventListener('pointermove', onMove, { passive: true })
</script>